<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ”§ Backend Dashboard - Swiss Cup Crawler</title>
    <link rel="stylesheet" href="/backend-dashboard.css">
</head>
<body>
    <div class="dashboard-container">
        <header class="dashboard-header">
            <div class="header-content">
                <h1>ğŸ”§ Backend Dashboard</h1>
                <div class="header-actions">
                    <span class="user-info">Eingeloggt seit: <span id="loginTime">LÃ¤dt...</span></span>
                    <button class="btn btn-logout" onclick="logout()">ğŸšª Logout</button>
                </div>
            </div>
        </header>

        <nav class="dashboard-nav">
            <a href="/dev/dbreview.html" class="nav-item">ğŸ“Š DB Review</a>
            <a href="/dev/gamedetails.html" class="nav-item">ğŸ® Game Details</a>
            <a href="/bracket" class="nav-item">ğŸ† Bracket View</a>
        </nav>

        <main class="dashboard-main">
            <!-- System Status Section -->
            <section class="status-section">
                <h2>ğŸ“ˆ System Status</h2>
                <div class="status-grid">
                    <div class="status-item">
                        <span class="status-label">Server Status</span>
                        <span class="status-value status-active" id="serverStatus">ğŸŸ¢ Online</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">Uptime</span>
                        <span class="status-value" id="uptime">LÃ¤dt...</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">Letzte Aktualisierung</span>
                        <span class="status-value" id="lastUpdate">-</span>
                    </div>
                </div>

                <div class="quick-stats">
                    <div class="stat-card">
                        <span class="stat-value" id="totalGames">-</span>
                        <span class="stat-label">Spiele Total</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-value" id="gameDetailsCount">-</span>
                        <span class="stat-label">Game Details</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-value" id="gameEventsCount">-</span>
                        <span class="stat-label">Game Events</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-value" id="bracketSorted">-</span>
                        <span class="stat-label">Bracket-sortiert</span>
                    </div>
                </div>
            </section>

            <!-- Backend Interface Section -->
            <section class="backend-interface-section">
                <h2>âš™ï¸ Backend Management</h2>
                
                <div class="alert alert-info">
                    <strong>Info:</strong> Hier kÃ¶nnen Sie alle Backend-Funktionen ausfÃ¼hren und verwalten.
                </div>
                
                <div class="backend-grid">
                    <!-- Quick Update -->
                    <div class="backend-card">
                        <div class="backend-icon">ğŸ’</div>
                        <h3>Quick Update</h3>
                        <p>Aktuelle Saison crawlen + Bracket-Sortierung + Prognose-Spiele fÃ¼r alle 4 Cups</p>
                        <button class="btn btn-warning" onclick="executeQuickUpdate()">
                            âš¡ Quick Update starten
                        </button>
                        <div class="backend-status" id="quickUpdateStatus"></div>
                    </div>
                    
                    <!-- Cup-Daten Management -->
                    <div class="backend-card">
                        <div class="backend-icon">ğŸ“¥</div>
                        <h3>Cup-Daten Management</h3>
                        <p>Crawle oder lÃ¶sche Cup-Daten fÃ¼r gewÃ¤hlte Saison</p>
                        <select class="season-select" id="crawlSeasonSelect">
                            <option value="2025/26">2025/26 (Aktuell)</option>
                            <option value="all">Alle Saisons</option>
                            <option value="2024/25">2024/25</option>
                            <option value="2023/24">2023/24</option>
                            <option value="2022/23">2022/23</option>
                        </select>
                        <div class="cup-data-actions">
                            <button class="btn btn-info btn-small" onclick="executeCrawling()">
                                ğŸ“¡ Crawling starten
                            </button>
                            <button class="btn btn-danger btn-small" onclick="executeCupDataDelete()">
                                ğŸ—‘ï¸ Season lÃ¶schen
                            </button>
                        </div>
                        <div class="backend-status" id="crawlingStatus"></div>
                    </div>

                    <!-- Teamshorts CSV Upload -->
                    <div class="backend-card">
                        <div class="backend-icon">ğŸ·ï¸</div>
                        <h3>Teamshorts Management</h3>
                        <p>Team-AbkÃ¼rzungen per CSV hochladen und synchronisieren</p>
                        <input type="file" id="teamshortsCsv" accept=".csv" class="file-input" />
                        <button class="btn btn-primary btn-small" onclick="executeTeamshortsUpload()">
                            ğŸ“ CSV Upload & Sync
                        </button>
                        <div class="backend-status" id="teamshortsStatus"></div>
                    </div>
                    
                    <!-- Bracket-Sortierung Management -->
                    <div class="backend-card">
                        <div class="backend-icon">ğŸ¯</div>
                        <h3>Bracket-Sortierung Management</h3>
                        <p>Berechne oder setze Bracket-Sortierung zurÃ¼ck</p>
                        <select class="season-select" id="bracketSeasonSelect">
                            <option value="2025/26">2025/26 (Aktuell)</option>
                            <option value="all">Alle Saisons</option>
                            <option value="2024/25">2024/25</option>
                            <option value="2023/24">2023/24</option>
                            <option value="2022/23">2022/23</option>
                        </select>
                        <div class="bracket-management-actions">
                            <button class="btn btn-success btn-small" onclick="executeBracketSorting()">
                                ğŸ”¢ Berechnung starten
                            </button>
                            <button class="btn btn-warning btn-small" onclick="executeBracketReset()">
                                ğŸ”„ Sortierung zurÃ¼cksetzen
                            </button>
                        </div>
                        <div class="backend-status" id="bracketStatus"></div>
                    </div>
                    
                    <!-- Prognose-Spiele Management -->
                    <div class="backend-card">
                        <div class="backend-icon">ğŸ”®</div>
                        <h3>Prognose-Spiele Management</h3>
                        <p>Generiere oder lÃ¶sche Prognose-Spiele fÃ¼r gewÃ¤hlte Saison</p>
                        <select class="season-select" id="prognoseSeasonSelect">
                            <option value="2025/26">2025/26 (Aktuell)</option>
                            <option value="2024/25">2024/25</option>
                            <option value="2023/24">2023/24</option>
                            <option value="2022/23">2022/23</option>
                        </select>
                        <div class="prognose-actions">
                            <button class="btn btn-primary btn-small" onclick="executePrognoseGenerate()">
                                âš¡ Generieren
                            </button>
                            <button class="btn btn-danger btn-small" onclick="executePrognoseCleanup()">
                                ğŸ—‘ï¸ Cleanup aktuell
                            </button>
                            <button class="btn btn-warning btn-small" onclick="executePrognoseSeasonDelete()">
                                ğŸ—‘ï¸ Season lÃ¶schen
                            </button>
                        </div>
                        <div class="backend-status" id="prognoseStatus"></div>
                    </div>
                    
                    <!-- Game Details Crawling -->
                    <div class="backend-card">
                        <div class="backend-icon">ğŸ®</div>
                        <h3>Game Details Crawling</h3>
                        <p>Crawle detaillierte Spielinformationen von Swiss Unihockey API fÃ¼r gewÃ¤hlte Saison</p>
                        <select class="season-select" id="gameDetailsSeasonSelect">
                            <option value="2025/26">2025/26 (Aktuell)</option>
                            <option value="all">Alle verfÃ¼gbaren Seasons</option>
                            <option value="2024/25">2024/25</option>
                            <option value="2023/24">2023/24</option>
                            <option value="2022/23">2022/23</option>
                        </select>
                        <div class="game-details-actions">
                            <button class="btn btn-info btn-small" onclick="executeGameDetailsCrawling()">
                                ğŸ¯ Season crawlen
                            </button>
               <button class="btn btn-success btn-small" onclick="executeGameDetailsRetryCrawling()">
    ğŸ”„ Robustes Retry-Crawling
</button>
                            <button class="btn btn-danger btn-small" onclick="executeGameDetailsDelete()">
                                ğŸ—‘ï¸ Season lÃ¶schen
                            </button>
                        </div>
                        <div class="backend-status" id="gameDetailsStatus"></div>
                    </div>

                    <!-- Game Events Crawling -->
                    <div class="backend-card">
                        <div class="backend-icon">âš¡</div>
                        <h3>Game Events Crawling</h3>
                        <p>Crawle Spielereignisse (Tore, Strafen, etc.) von Swiss Unihockey API fÃ¼r gewÃ¤hlte Saison</p>
                        <select class="season-select" id="gameEventsSeasonSelect">
                            <option value="2025/26">2025/26 (Aktuell)</option>
                            <option value="all">Alle verfÃ¼gbaren Seasons</option>
                            <option value="2024/25">2024/25</option>
                            <option value="2023/24">2023/24</option>
                            <option value="2022/23">2022/23</option>
                        </select>
                        <div class="game-events-actions">
                            <button class="btn btn-info btn-small" onclick="executeGameEventsCrawling()">
                                âš¡ Season crawlen
                            </button>
                            <button class="btn btn-secondary btn-small" onclick="executeGameEventsAllCrawling()">
                                ğŸŒ Legacy Crawl (alle)
                            </button>
                            <button class="btn btn-danger btn-small" onclick="executeGameEventsDelete()">
                                ğŸ—‘ï¸ Season lÃ¶schen
                            </button>
                        </div>
                        <div class="backend-status" id="gameEventsStatus"></div>
                    </div>

                    <!-- Season Komplett-LÃ¶schung -->
                    <div class="backend-card">
                        <div class="backend-icon">ğŸ’¥</div>
                        <h3>Season Komplett-LÃ¶schung</h3>
                        <p>âš ï¸ ACHTUNG: LÃ¶scht ALLE Daten einer Season unwiderruflich</p>
                        <select class="season-select" id="completeDeleteSeasonSelect">
                            <option value="">-- Season wÃ¤hlen --</option>
                            <option value="2024/25">2024/25</option>
                            <option value="2023/24">2023/24</option>
                            <option value="2022/23">2022/23</option>
                        </select>
                        <div class="complete-delete-actions">
                            <button class="btn btn-danger" onclick="executeCompleteSeasonDelete()">
                                ğŸ’¥ Season KOMPLETT lÃ¶schen
                            </button>
                        </div>
                        <div class="backend-status" id="completeDeleteStatus"></div>
                    </div>
                </div>
            </section>
            
            <!-- Admin Tools Section -->
            <section class="admin-section">
                <h2>âš™ï¸ Admin Tools</h2>
                <div class="admin-buttons">
                    <a href="/stats" class="btn btn-info btn-small">ğŸ“Š Statistiken</a>
                    <a href="/games/all" class="btn btn-info btn-small">ğŸ“‹ Alle Spiele</a>
                    <a href="/bracket-sorting-status" class="btn btn-info btn-small">ğŸ¯ Bracket Status</a>
                    <a href="/health" class="btn btn-success btn-small">â¤ï¸ Health Check</a>
                    <a href="/api/seasons" class="btn btn-secondary btn-small">ğŸ“… API: Seasons</a>
                    <a href="/api/cups" class="btn btn-secondary btn-small">ğŸ† API: Cups</a>
                    <a href="/api/stats" class="btn btn-secondary btn-small">ğŸ“Š API: Stats</a>
                </div>
            </section>
        </main>
    </div>

    <script src="/backend-functions.js"></script>
    <script>
        // Status beim Laden prÃ¼fen
        checkStatus();
        
        // Status alle 30 Sekunden aktualisieren
        setInterval(checkStatus, 30000);
    </script>
</body>
</html>